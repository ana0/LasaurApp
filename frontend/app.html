<!DOCTYPE html>
<html lang="en">
<head> 
    
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<title>LasaurApp</title> 
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css"> 
<link rel="stylesheet" href="/css/jquery.toastmessage.css" type="text/css"> 
<link rel="stylesheet" href="/css/style.css" type="text/css">
<script src="/js/jquery-1.7.2.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.toastmessage.js"></script>
<script src="/js/jquery.hotkeys.js"></script>
<script src="/js/settings.js"></script>
<script src="/js/app_svgreader.js"></script>
<script src="/js/app_datahandler.js"></script>
<script src="/js/app_canvas.js"></script>
<script src="/js/app.js"></script>
<script src="/js/app_laserjobs.js"></script>
<script src="/js/app_mover.js"></script>
<script src="/js/app_import.js"></script>

</head>
<body>

    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
                </a>
                <div class="btn-group pull-right">
                    <button id="connect_btn" class="btn btn-warning" type="submit">Disconnected</button>
                    <button id="door_status_btn" class="btn disabled btn-warning" type="submit">Door</button>
                    <button id="chiller_status_btn" class="btn disabled btn-warning" type="submit">Chiller</button>
                </div>
                <div class="btn-group pull-right">
                    <button id="go_to_origin" class="btn" type="submit" title="move to origin">(0,0)</i></button>
                    <button id="homing_cycle" class="btn" type="submit" title="run homing cycle, find table origin"><i class="icon-home"></i></button>
                    <button id="cancel_btn" class="btn" type="submit" title="stop and purge job"><i class="icon-stop"></i></button>
                </div>      
                <button id="pause_btn" class="btn pull-right" type="submit" title="pause/continue"><i class="icon-pause"></i></button>
                <a class="brand" href="/" style="color:#666666"><img src="/img/lasersaur-dino-brand.png" style="margin-right:6px">LasaurApp</a>
                <div class="nav-collapse">
                    <ul class="nav">
                        <li><a href="#about_modal" data-toggle="modal">About</a></li>
                        <li><a href="#ttl_modal" data-toggle="modal">Help</a></li>  
                        <li><a href="#speeds_modal" data-toggle="modal">Cutting Speeds</a></li>  
                        <li class="divider-vertical"></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Manual<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="http://labs.nortd.com/lasersaur/manual/">Manual TOC</a></li>
                                <li><a href="http://labs.nortd.com/lasersaur/manual/operation">Operating a Lasersaur</a></li>
                                <li><a href="http://labs.nortd.com/lasersaur/manual/lasertags">LaserTags</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Admin<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <!--<li><a href="flash_firmware">Flash Firmware (latest from github)</a></li>-->
                                <li><a href="build_firmware">Build and Flash from Source</a></li>
                                <li><a id="reset_atmega" href="reset_atmega">Reset Atmega (restarts firmware)</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!-- about modal -->
    <div id="about_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="about_label" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="about_label">About LasaurApp</h3>
        </div>
        <div class="modal-body">
            <p><img src="/img/lasersaur-black_w530.jpg"></p>
            <div style="width:60px;margin-left:auto;margin-right:auto;margin-top:20px;margin-bottom:20px"><img src="/img/lasersaur-dino.png" style="width:60px"></div>
            <p>LasaurApp is the offical control app for the Lasersaur laser cutter and part of the <a href="http://labs.nortd.com/lasersaur/">Lasersaur project</a>. This software is made available under the <a href="https://gnu.org/licenses/gpl.html">GPLv3 (version 3 or later)</a> software license. Copyright (c) 2013 <a href="http://labs.nortd.com/">Nortd Labs</a></p>
            <ul>
            <li>LasaurApp version <span id="lasaurapp_version"></span></li>
            <li>Firmware version <span id="firmware_version">&lt;not connected&gt;</span></li>
            </ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
        </div>
    </div>

    <!-- ttl modal -->
    <div id="ttl_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="ttl_label" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="ttl_label">Toronto Tool Library laser guidelines</h3>
        </div>
        <div class="modal-body">
            <h3>Note – You cannot use the laser if you haven’t taken the maintenance workshop.</h3><br>
            <h3>Help video found <a href="https://www.youtube.com/watch?v=WbYeNyBV8MM"</a></b3>Here</a></h3>
            <h3>Also read this for general laser knowledge <a href="http://www.instructables.com/id/10-Tips-and-Tricks-for-Laser-Engraving-and-Cutting/step7/Tip-7-Adding-a-vector-score-to-the-edge-of-type-or/"</a></b3>here</a></h3> 
            <strong>Table of contents</strong>
            <ol><li><a href="#startingup">Starting Up</a></li>
            <li><a href="#startingajob">Starting a Job</a></li>
            <li><a href="#positioning">Positioning of Job/Design</a></li>
            <li><a href="#dpiandresolution">Dpi settings and resolution</a></li></ol><br>
            <strong>Troubleshooting</strong>
            <ol><li><a href="#connectionproblems">Problems connecting</a></li>
            <li><a href="#cuttingproblems">Problems with cutting</a></li></ol>
            <br>
            <a name="startingup"><h3>Starting Up</h3></a>
            <br>
            <p>Make sure you turn on the laser and the FAN before anything else. This is done with the plug on the “vortex” fan in the back workshop being plugged in and the power bar to the right of the laser being turned on.</p>
            <p>Also rotate the emergency button clockwise to turn on the lasersaur's motors and lights.</p>
            <p>Next, open your laptop and access you browser, i.e. Firefox, chrome, explorer, safari, etc. (NOTE* safari cannot run the lasersaur app in most cases because it doesn’t have API capabilities… Don’t ask)</p>
            <p>Login to the Laser with the IP address <strong>192.168.2.199</strong> or <strong>lasersaur.local</strong> typed into the address bar.</p>
            <p>Should look like this:</p>
            <p><img src="/img/laserapp-screenshot.png"></p>
            <p><img src="/img/door-disconnected.png"></p>
            <p>Except it will be green and say connected instead.</p>
            <p>If you are already on the lasersaur app, remember that the lasersaur app needs a few seconds to flash to the IP Address and be accessible.</p>
            <br>
            <a name="startingajob"><h3>Starting a Job</h3></a>
            <br>
            <p>You should now be able to get a file loading into the lasersaur app.</p>
            <p>Click the “File Import” button like this:</p>
            <p><img src="/img/file-import.png"></p>
            <p>And import your designs as an .svg or .dxf file.</p>
            <p>If you're exporting a .dxf, it needs to be the oldest version, R14, with all elements in the file only being lines and arcs. When exporting from Rhino, the "“file export” – “edit schemes” window should look like this:</p>
            <p><img src="/img/autocad-export.png"></p>
            <p>AutoCAD, solidworks, freeCAD, sketchup, and many more can do it also. Type it in google to find out. Inkscape is the next best solution because it can change most files into .svg’s, which always work.</p>
            <br>
            <a name="positioning"><h3>Positioning a Job/Design</h3></a>
            <br>
            <p>The design/art/lines/whatever you put into the lasersaur app will be placed wherever your job was saved in the design software. All design software has 0,0 origins that indicate a reference point from which all the work revolves around. In most software there is an option to move the design to the origin. This won’t help because the laser needs an origin at the top left of wherever the design is. See the picture below:</p>
            <p><img src="/img/position-guidelines.png"></p>
            <p>In Inkscape, if you want to represent the whole cutting area of the laser in your drawing you can follow the picture below after going to “File” – “document properties” and changing the Width = 48 and Height = 24. This means 48” by 24” or 4’ by 2’.</p>
            <p><img src="/img/inkscape-filesize.png"></p>
            <p>You can also click “Resize page to drawing or selection”. This will create a page the same size as your design. This works well for centering design over pre-determined material dimensions that the design will fit into. Or, if you material is larger, type in the dimensions into Width and Height boxes provided in the document properties window. Centre the design over the material like in the image below using the right angle edge provided at the top and left side of the lasers bed area.</p>
            <p>Also, if that doesn’t position it the way you need to, you can always use Move/Jog Tab that looks like this:</p>
            <p><img src="/img/move-jog-button.png"></p>
            <p>In this window you can use powerful commands that relocate you “ZERO” to wherever you need it. This feature works well in the event that your “as build material” is either:</p>
            <ul><li>Too thick and must be placed in between the frame underneath the honeycomb bed</li>
            <li>Is already cut in the top left area</li>
            <li>Is weathered or damaged in the top left area</li>
            <li>Need touch ups only in areas not cut the first time</li></ul>
            <p>Click on the Move/Job tab on the left and then using the cursor over the boxed area, click in the area you would like to work in. Alternatively, you can shift click that area or use your directional pad on your laptop to move the laser lens where you want. Each click gets you 10 mm distance.</p>
            <p><img src="/img/manual-alignment-screen.png"></p>
            <p>Make sure the button “move” is selected at the bottom of the “Move/Job” tab when making an offset move. Offset move means that you are offsetting the “ZERO” from the top left corner to a location more desirable.</p>
            <p>Notice in the picture below the dotted lines indicate the new edge for both top and left side of the cutting area:</p>
            <p><img src="/img/offset.png"></p>
            <p>Alternatively, you can use the "d-pad" or directional pad on your computer to move the laser's head from right to left , down and up.</p>
            <p>Each movement is 10mm of movement. For fine movement you can hold ALT or Option and the head will move 2mm instead. When clicking or using the directional pad to get you the desired area, you will need to select “offset to” which looks like this:</p>
            <p><img src="/img/offset-button.png"></p>
            <p>Only click after the lens has reached the desired position and waited 5 seconds. This is a necessary update time for the laser.</p>
            <br>
            <a name="dpiandresolution"><h3>Dpi settings and resolution</h3></a>
            <br>
            <p>When setting your dpi (dotted per inch) in the design, make sure it is either 72, 90 or 96dpi. The lasersaur is optimized for these sizes. If you are saving a design through Inkscape, the dpi will be 90 as default. With Illustrator, it will be 72.</p>
            <p>Any resolution for any photo or design you wish to cut will overload the laser if it is above 300 pixels. If you notice the lasersaur app isn’t loading you design, it might be because the resolution is TOO HIGH.</p>
            <p>If you ever notice your design is coming through the laser at a different scale then intended, try clicking “import with optimizing” like in the photo below. If you don’t know the dpi of the design software you are using, you can usually find it under file, setting or preferences.</p>
            <p><img src="/img/laser-upload-screenshot.png"></p>
            <br>
            <a name="connectionproblems"><h3>Problems Connecting</h3></a>
            <br>
            <p>First thing, make sure you are connected to the Wi-Fi connection with the Toronto Tool Library LAN network. The password is <strong>sharetools2013</strong></p>
            <p>Open a browser and type in the address bar this IP address: <stong>192.168.2.199</stong></p>
            <p>If that doesn't load, try typing: <strong>lasersaur.local</strong></p>
            <p>If you are getting problems connecting and your screen looks like the picture below:</p>
            <p><img src="/img/door-disconnected.png"></p>
            <p>Or doesn’t display anything at all…. It means the laser’s computer has stalled or it needs more time to boot.</p>
            <p>Wait 30 seconds and refresh your page. If there is still no connection, hit the emergency stop button (just a shut-off at this point) and wait 3 seconds, then twist it clockwise go start the laser again.</p>
            <p>This will reset the lasersaur app and it should start working. If you still don’t have contact, try using another browser or computer.</p>
            <br>
            <a name="cuttingproblems"><h3>Problems Cutting</h3></a>
            <br>
            <p>If you seems to be unable to cut through any material, even at a low speed of 400-500 F (F=feederate in mm/min), then there is a small problem.</p>
            <p>Check the following things before contacting any staff at the TTL.</p>
            <ol><li>Is the power at %100?</li>
            <li>Is your material very thick? Remember that ½” or 12.5mm is the maximum you can safely cut any material</li>
            <li>Is your focus properly adjusted? (refer to focus adjustment or click <a href="https://www.youtube.com/watch?v=wvyWbFlio3E"</a></b3>Here</a></h3> ) if not, make sure it’s in the centre of the material or at the top for acrylic cutting</li>
            <li>Is the gantry aligned. Try realigning it by pushing the big red button on the right side (E-stop), then pcushing the centre aluminum bar to the back as far as it goes and finally restarting the laser by rotating the E-stop clockwise. Wait 30 sec for the lasersaur app to re-boot and try cutting again.</li>
            <li>Is the nozzle where the laser comes out of hot? If so, contact the TTL staff.</li></ol>
            <br>            
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
        </div>
    </div>

    <!-- speeds modal -->
    <div id="speeds_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="about_label" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="speeds_label">Cutting Speeds Guidelines</h3>
        </div>
        <div class="modal-body">
            <table style="width:100%">
                <tr>
                    <td><strong>Material</strong></td>
                    <td><strong>Thickness</strong></td>
                    <td><strong>Feedrate (F)</strong></td>
                    <td><strong>Power (%)</strong></td>
                    <td><strong>Operator</strong></td>
                </tr>
                <tr>
                    <td>Cardboard</td>
                    <td>4 mm</td>
                    <td>2000</td>
                    <td>60</td>
                    <td>Adam</td>
                </tr>
	
                <tr>
                    <td>Plywood</td>
                    <td>3/16"</td>
                    <td>600</td>
                    <td>100</td>
                    <td>Adam</td>
                </tr>
                 <tr>
                    <td>paper stock</td>
                    <td>1mm</td>
                    <td>2000</td>
                    <td>90</td>
                    <td>Rory</td>
                </tr>        
                <tr>
                    <td>Plywood</td>
                    <td>1/8"</td>
                    <td>700</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>matbaord</td>
                    <td>1mm</td>
                    <td>2000</td>
                    <td>60</td>
                    <td>Rory</td>
                </tr>
                 <tr>
                    <td>hardborad</td>
                    <td>6mm</td>
                    <td>300</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
	        <tr>
                    <td>Acrylic</td>
                    <td>3/8"</td>
                    <td>200</td>
                    <td>100</td>
                    <td>Adam</td>
                </tr>
                <tr>
                    <td>Paper Board</td>
                    <td>1 mm</td>
                    <td>1500</td>
                    <td>40</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Acrylic</td>
                    <td>2 mm</td>
                    <td>900</td>
                    <td>60</td>
                    <td>Rory</td>
                </tr>
                 <tr>
                    <td>Acrylic</td>
                    <td>6 mm</td>
                    <td>350</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Clear Acrylic</td>
                    <td>14 mm</td>
                    <td>300 x 2 passes</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>  
                 <tr>
                    <td>Clear Acrylic</td>
                    <td>5.6 mm</td>
                    <td>350</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                 <tr>
                    <td>Tinted Acrylic</td>
                    <td>6 mm</td>
                    <td>350</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr> 
                <tr>
                    <td>Birch Plywood</td>
                    <td>1/4"</td>
                    <td>400</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Particle Board</td>
                    <td>1/2"</td>
                    <td>400 x 2 Passes</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Acrylic</td>
                    <td>1/8"</td>
                    <td>700</td>
                    <td>90</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Clear Acrylic</td>
                    <td>1/16"</td>
                    <td>1500</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>White Acrylic</td>
                    <td>1/8"</td>
                    <td>1500</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Black Acrylic</td>
                    <td>1/8"</td>
                    <td>900</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Cedar</td>
                    <td>5/8"</td>
                    <td>400</td>
                    <td>100</td>
                    <td>Rafal</td>
                </tr>
                <tr>
                    <td>Blotting Paper</td>
                    <td>1 mm</td>
                    <td>2300</td>
                    <td>28</td>
                    <td>Cosmo</td>
                </tr>
                <tr>
                    <td>Acrylic</td>
                    <td>11 mm</td>
                    <td>200</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Leather</td>
                    <td>4 mm</td>
                    <td>700</td>
                    <td>80</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Acrylic</td>
                    <td>3.5 mm</td>
                    <td>900</td>
                    <td>90</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Particle Board</td>
                    <td>5/8"</td>
                    <td>400 x 2 Passes</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>MDF</td>
                    <td>2.2 mm</td>
                    <td>650</td>
                    <td>100</td>
                    <td>Andrew</td>
                </tr>
                <tr>
                    <td>MDF</td>
                    <td>3/8"</td>
                    <td>500 x 3 Passes</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Pine/Hemlock</td>
                    <td>5/8"</td>
                    <td>200+500</td>
                    <td>100</td>
                    <td>Vishal</td>
                </tr>
                <tr>
                    <td>Hard Board</td>
                    <td>1/4"</td>
                    <td>600</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Delrin</td>
                    <td>1/4"</td>
                    <td>250</td>
                    <td>100</td>
                    <td>Rory</td>
                </tr>
                <tr>
                    <td>Delrin</td>
                    <td>1/16"</td>
                    <td>1400</td>
                    <td>40</td>
                    <td>Rory</td>
                </tr>
            </table>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
        </div>
    </div>

    <!-- cancel modal -->
    <div id="cancel_modal" class="modal hide" tabindex="-1" role="dialog" aria-labelledby="cancel_modal_label" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="cancel_modal_label">Stop Job</h3>
        </div>
        <div class="modal-body">
            <p>Press ENTER to confirm stopping the current job.</p>
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button id="really_cancel_btn" class="btn btn-danger">Stop Job!</button>
        </div>
    </div>
    
    
    <div id="container" class="container">
        <div class="row">
            <div class="span12">
                <div class="tabbable row">
                    
                    <!--tabbar start-->
                    <div class="span2 tabs-left">
                        <ul class="nav nav-tabs" style="width:100%">            
                            <li class="active"><a href="#tab_jobs" id="tab_jobs_button" data-toggle="tab"><i class="icon-th-list" style="margin-right:2px"></i> Laser Jobs</a></li>
                            <li><a href="#tab_import" id="tab_import_button" data-toggle="tab"><i class="icon-folder-open" style="margin-right:2px"></i> File Import</a></li>
                            <li><a href="#tab_mover" id="tab_mover_button" data-toggle="tab"><i class="icon-move" style="margin-right:2px"></i> Move/Jog</a></li>
                            <li><a href="#tab_logs" id="tab_logs_button" data-toggle="tab"><i class="icon-exclamation-sign" style="margin-right:2px"></i> Logs</a></li>                         
                        </ul>
                    </div>
                    <!--tabbar end-->
                    <div class="span10">    
                        <div class="tab-content" style="overflow:visible; padding-bottom:30px">              
                            <!--content start-->
                            
                            <div id="tab_jobs" class="tab-pane active">
                                <div style="width:650px;">
                                    <div class="well clearfix" style="margin-bottom:40px">
                                        <input type="text" id="job_name" style="width:296px" placeholder="Load or import a job.">
                                        <button id="file_import_quick_btn" class="btn pull-right" title="file import" data-delay="500">
                                            <span class="icon-folder-open"></span>
                                        </button>
                                        <textarea id="job_data" style="display:none"></textarea>
                                        <div id="preview_canvas_container"></div>
                                        <!-- passes -->
                                        <div id="passes_container" class="well clearfix" style="width:594px; margin:0px; margin-top:10px; padding:8px; background-color:#dddddd; display:none">
                                            <div id="passes_info" class="pull-right" style="width:180px; color:#888888; display:none">
                                                <p>Vector cuts: Use one or more passes with different cut parameters (feedrate, intensity). Assign path colors to passes as needed.</p>
                                                <p>Need <a id="add_pass_btn" href="">more passes?</a></p>
                                            </div>
                                            <div id="passes" class="pull-left" style="width:400px">
                                                <!-- passes go here -->                                     
                                            </div>
                                        </div>
                                        <div style="padding-top:20px">
                                            <div class="btn-group pull-left">
                                                <button id="job_submit" class="btn btn-large btn-primary">Send to Lasersaur</button>
                                                <button id="job_bbox_submit" class="btn btn-large btn-primary" title="send bounding box to lasersaur" data-delay="500">
                                                    <span class="icon-resize-full icon-white"></span>
                                                </button>
                                            </div>
                                            <div id="stats_after_name" class="pull-left" style="margin-left:20px;padding-top:10px;color:#888888"></div>
                                            <div class="btn-group pull-right">
                                                <a class="btn btn-large dropdown-toggle" data-toggle="dropdown" href="#">
                                                    <span class="icon-share-alt"></span>
                                                    <span class="caret"></span>
                                                </a>
                                                <ul class="dropdown-menu">
                                                    <li><a id="export_json_btn" href="#">Export Job as JSON</a></li>
                                                    <li><a id="export_gcode_btn" href="#">Export Job as G-Code</a></li>
                                                </ul>
                                            </div>
                                            <button id="job_save_to_queue" class="btn btn-large pull-right" title="add to queue" data-delay="500" style="margin-right:10px">
                                                    <span class="icon-th-list"></span>
                                            </button>                                            
                                        </div>
                                        <div id="progressbar" class="progress progress-striped" style="margin-top:70px; clear:both">
                                            <div class="bar" style="width:0%;"></div>
                                            <div id="percentageDisplay">
  												Current Percentage: <b><span id="percentAmount">0</span></b>%
                                        	</div>
                                        </div>
            
                                        
                                    </div>
                                    <button id="clear_queue" class="btn btn-mini pull-right" title="delete non-starred jobs" data-delay="500">
                                        clear
                                    </button>
                                    <h3>Recent Jobs</h3>
                                    <div> 
                                        <ul id="job_queue" class="nav nav-tabs nav-stacked">
                                            <!-- job queue -->
                                        </ul>
                                        <div class="btn-group dropup">
                                            <a class="btn btn-large dropdown-toggle" data-toggle="dropdown" href="#">
                                                Library Jobs
                                                <span class="caret"></span>
                                            </a>
                                            <ul id="job_library" class="dropdown-menu"></ul>
                                                <!-- stock library go here -->
                                            </ul>
                                        </div>
                                    </div> 
                                </div>                             
                            </div>
                            
                            <div id="tab_import" class="tab-pane">                                                  
                                <div class="well clearfix" style="width:610px">

                                    <div class="row" style="margin-left:0px">                                       
                                    <div class="btn-group pull-left">
                                            <button id="file_import_btn" class="btn btn-large" data-loading-text="loading..." autocomplete="off">
                                                <i class="icon-folder-open"></i> Import
                                            </button>
                                        <button class="btn btn-large dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                                        <ul class="dropdown-menu">
                                            <li><a id="svg_import_72_btn" href="#">Import 72dpi SVG(Illistrator)</a></li>
                                            <li><a id="svg_import_90_btn" href="#">Import 90dpi SVG(inkscape)</a></li>
                                            <li><a id="svg_import_96_btn" href="#">Import 96dpi SVG</a></li>
                                                <li class="divider"></li>
                                            <li><a id="svg_import_nop_btn" href="#">Import for hatchfilling</a></li>
                                        </ul>
                                    </div>
                                        <div id="dpi_import_info" class="pull-left" style="margin:10px"></div>
                                        
                                        <div class="pull-left">
                                            <form id="svg_upload_form" action="#" onsubmit="return false;">
                                                <input type="file" id="svg_upload_file" name="data" style="visibility:hidden; position:fixed">
                                            </form>
                                        </div>
                                    </div>
                                    <div id="import_canvas_container" style="margin-top:16px;"></div>                                       
                                    <div id="canvas_properties">
                                        <div class="colorbtns"></div>
                                    </div>                                              
                                    <div class="pull-left">
                                        <button id="import_to_queue" class="btn btn-large" style="margin-top:16px">
                                            <i class="icon-th-list"></i> Add to Queue
                                        </button>
                                    </div>
                                    <div class="pull-left" style="margin-top:27px; margin-left:20px">
                                        under name
                                    </div>
                                    <div class="pull-left" style="margin-top:22px; margin-left:10px">                            
                                        <input type="text" id="import_name" style="width:240px" placeholder="Name...">
                                    </div>
                                </div> <!--end of well-->
                                
                                <div class="alert" style="width:400px">
                                    <a class="close" data-dismiss="alert">×</a>
                                    <strong>Note!</strong> Set page size in your SVG vector app to <b id="bed_size_note"></b>.
                                </div>      
                                <div class="alert" style="width:400px">
                                    <a class="close" data-dismiss="alert">×</a>
                                    <strong>Note!</strong> Set cutting parameters in the SVG file with <a href="http://labs.nortd.com/lasersaur/manual/lasertags">LaserTags</a>.
                                </div>                                                  
                            </div> <!-- end of import tab -->                           

                            <div id="tab_mover" class="tab-pane" style="margin-left:0px">
                                <div class="well" style="width:610px">
                                    <div class="row" style="margin-left:0px">
                                        <div id="cutting_area" style="position:relative; width:610px; height:305px; border:1px dashed #aaaaaa;">
                                            <div id="coordinates_info" style="margin:4px"></div>
                                            <div id="offset_area" style="display:none; position:absolute; top:100px; left:100px; width:100px; height:100px; border-top:1px dashed #aaaaaa; border-left:1px dashed #aaaaaa">
                                                <div id="offset_info" style="margin:4px"></div>
                                            </div>
                                        </div>  
                                    </div>
                                    <div class="row" style="width:475px; margin-left:auto; margin-right:auto; margin-top:20px">
                                        <div id="seek_feed_btns" class="btn-group pull-left" data-toggle="buttons-radio">
                                            <button id="seek_btn" class="btn active">Move</button>
                                            <button id="feed_btn" class="btn">Cut</button>
                                        </div>
                                        <div id="intensity_input_div" class="input-prepend pull-left" style="margin-left:8px; margin-top:1px;">
                                            <span class="add-on" style="margin-right:-5px;">%</span>
                                            <input id="intensity_field" type="textfield" value="0" style="width:26px; display:none">
                                            <input id="intensity_field_disabled" type="textfield" class="disabled" disabled="" value="0" style="width:26px;">
                                        </div>                                  
                                        <div id="feedrate_btns" class="btn-group pull-right" data-toggle="buttons-radio">
                                            <button id="feedrate_btn_slow" class="btn">slow</button>
                                            <button id="feedrate_btn_medium" class="btn">medium</button>
                                            <button id="feedrate_btn_fast" class="btn active">fast</button>
                                        </div>
                                        <div class="input-append pull-right" style="margin-right:8px; margin-top:1px;">
                                            <input id="feedrate_field" type="textfield" value="8000" style="width:36px;">
                                            <span class="add-on" style="margin-left:-5px;">mm/min</span>
                                        </div>                                      
                                    
                                    </div>
                                    <div class="row clearfix" style="width:400px; margin-left:auto; margin-right:auto; margin-top:16px">
                                        <div class="well pull-left" style="width:140px; height:130px; background-color:#dddddd">
                                            <div class="row" style="width:44px; margin-left:auto; margin-right:auto;">
                                                <button id="jog_up_btn" class="btn btn-large"><i class="icon-arrow-up"></i></button>
                                            </div>
                                            <div class="row" style="width:140px; margin-left:auto; margin-right:auto; margin-top:8px">
                                                <button id="jog_left_btn" class="btn btn-large pull-left"><i class="icon-arrow-left"></i></button>
                                                <button id="jog_right_btn" class="btn btn-large pull-right"><i class="icon-arrow-right"></i></button>
                                            </div>
                                            <div class="row" style="width:44px; margin-left:auto; margin-right:auto; margin-top:8px">
                                                <button id="jog_down_btn" class="btn btn-large"><i class="icon-arrow-down"></i></button>
                                            </div> 
                                        </div>
                                        <div class="well pull-right" style="width:168px; height:130px; background-color:#dddddd">
                                            <div class="btn-group" style="margin-top:26px; margin-bottom:14px">
                                                <button id="location_set_btn" class="btn"><span id="loc_move_cut_word">Move</span>To</button>
                                                <button id="origin_set_btn" class="btn">OffsetTo</button>
                                            </div>                                        
                                            <div class="input-prepend pull-left">
                                                <span class="add-on" style="margin-right:-5px;">x</span>
                                                <input id="x_location_field" type="textfield" value="0" style="width:48px;">
                                            </div> 
                                            <div class="input-prepend pull-left" style="margin-left:4px;">
                                                <span class="add-on" style="margin-right:-5px;">y</span>
                                                <input id="y_location_field" type="textfield" value="0" style="width:42px;">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" style="width:210px; margin-left:auto; margin-right:auto;">
                                        <button id="air_on_btn" class="btn">Air Assist On</button>
                                        <button id="air_off_btn" class="btn">Air Assist Off</button>
                                    </div>                                  
                                </div>
                                <div class="alert" style="width:400px">
                                    <a class="close" data-dismiss="alert">×</a>
                                    <strong>Note!</strong> Set an offset by shift-clicking in the work area.
                                </div>   
                                <div class="alert" style="width:400px">
                                    <a class="close" data-dismiss="alert">×</a>
                                    <strong>Note!</strong> User arrow keys to jog. De/increase step with alt and shift.
                                </div>                                                              
                            </div> <!-- end of mover tab -->                    

                            <div id="tab_logs" class="tab-pane active">
                                <div class="alert" style="margin:5px; display:none">
                                    <a class="close" data-dismiss="alert">×</a>
                                    Log, most recent messages first:
                                </div>                              
                                <div id="log_content" style="clear:both; overflow:auto; display:none">
                                    <!-- log -->
                                </div>
                            </div> <!-- end of log tab -->
<!--  START   CUSTOM GCODE TAB -->
                            <div id='tab_gcode' class='tab-pane'>
                                <div id='gcode_content'>
                                    <textarea id='gcode_edit' style='clear:both; width: 900px;' rows=20></textarea>
                                    <button id="gcode_submit" class="btn btn-large btn-primary">Send to Lasersaur</button>
                                </div>
                            </div>

                            <script>
                var chunksize = 5000;
                var gqueue = Array();
                function queue_gcode(gcode){
                    var tmp = gcode.split("\n");
                    var chunk = "";
                    var lc = 0;
                    for (var i=0; i<tmp.length; i++){
                        lc++;
                        chunk += tmp[i]+"\n";
                        if (lc>=chunksize){
                            gqueue.push(chunk);
                            lc=0;
                            chunk=""
                        }   
                    }
                    if (chunk.length>0){ gqueue.push(chunk); }  
                }

                function process_gcode_queue(){

                    if (progress_not_yet_done_flag==false && gqueue.length > 0){
                        gcode = gqueue.shift();
                        progress_not_yet_done_flag=true;
                        send_gcode(gcode, "New Chunk from Queue Sent.", true);  
                    }
                    setTimeout("process_gcode_queue()",5000);   
                }
                setTimeout("process_gcode_queue()",5000);

                $("#cancel_btn").click(function(e){
                    gqueue = Array();
                });

                                $('.tabs-left ul').append('<li><a href="#tab_gcode" id="tab_gcode_button" data-toggle="tab"><i class="icon-exclamation-sign" style="margin-right:2px"></i> Gcode</a></li>');
                                $("#gcode_submit").click(function(e) {
                                    var gcode = $('#gcode_edit').val();
                                    if (gcode){
                                        //send_gcode(gcode, "G-Code sent to backend.", true);
                                        queue_gcode(gcode); 
                    }
                                });
                            </script>
                            <!-- END      CUSTOM GCODE TAB -->
                            <!--content end-->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


</body>
</html>

